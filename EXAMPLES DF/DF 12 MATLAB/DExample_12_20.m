	% DExample 12.16	clear all	close all	clc	x1 = 1; x2 = 0; v1 = 0; v2 = 0; v3 = 0; v4 = 0; v5 = 0;		alfa = [-128 224 -207 -130 212]/256;	c1 = 1/2; c2 = 4; c3 = 1/4; c4 = 1/2; c5 = 2; c6 = 1/2;	a1 = alfa(1); a2 = alfa(2);a3 = alfa(3);a4 = alfa(4);a5 = alfa(5);			for n = 1:11		% Upper branch		Temp = a3*(-v3 - v2);		b31 = (-v3 + Temp);		v3 = v2  + Temp	;		Temp = a2*(b31 - v1);		b21 = b31 + Temp;		v2 = v1 + Temp;		Temp = a1*(b21 - x1);		b11 = b21 + Temp;		v1 = x1 + Temp;		% Lower branch		Temp = a5*(v5 - v4);		b51 = v5 + Temp;		v5 = v4 + Temp;		Temp = a4*(b51 - x1);		b41 = b51 + Temp;		v4 = x1 + Temp;		h(n) = 0.5*(b41 - b11);		x1 = 0;	end	%	figure(1)	%	PLOT_IMPULSE_RESPONSE_Z(h)	%	figure(2)	%	[G, Z, P] = h_2_Hz(h, 5);	%	PLOT_PZ_Z(Z, P)	%	zoom on	%	figure(3)	%	subplot('position', [0.11 0.4 0.88 0.5]);	wT = linspace(0, pi, 1000);	%	Taug = PZ_2_TG_Z(G, Z, P, wT);	%	Att = PZ_2_ATT_Z(G, Z, P, wT); 	%	axis_Amax = 60; axis_Tg_max= 30;	%	PLOT_A_TG_Z(Att, Taug, wT, axis_Amax, axis_Tg_max)			%	grid on	%===========	load mincost	alfa = [a1 a2 a3 a4 a5];	nmn=0;	delta = zeros(1,8);	c1 = 1/2; c2 = 4; c3 = 1/4; c4 = 1/2; c5 = 2; c6 = 1/2;	%	alfa = [a1 a2 a3 a4 a5 a6 a7];	Wd = 7; WX = 2^Wd; 	alfa0 = round(alfa*WX);	%	alfa0 = alfa*WX;	TempCost0 = 1000; TempCostM0 = 1000;	n1=7;n2=4;	WC = 2^24;		%	for nn = 1:100 	%		delta = RANDOM('Discrete Uniform',n1,1,5)-n2;	%	if nn==50000	%		n1=n1-2;n2=n2-1	%	end			delta=0	alfa = (alfa0 +delta)/WX;	%	alfa = (alfa0 )/WX;	a1 = alfa(1); a2 = alfa(2);a3 = alfa(3);a4 = alfa(4);a5 = alfa(5);			G11 = (1-a1)*c1;	G12 = -a1*a2;	G13 = -(1+a2)*a3*a1/c2;	G14 = -(1+a2)*(1+a3)*a1/(c2*c3);	%		G15 = 0;	%		G16 = 0;	%		G21 = 0;	G22 = (1-a2)*c2;	G23 = -a3*a2;	G24 = -(1+a3)*a2/c3;	%		G25 = 0;	%		G26 = 0;	%		G31 = 0;	%		G32 = 0;	G33 = (1-a3)*c3;	G34 = -a3;	%		G35 = 0;	%		G36 = 0;	G41 = (1-a4)*c4;	%		G42 = 0;	%		G43 = 0;	%		G44 = 0;	G45 = -a4*a5;	G46 = (1+a5)*a4/c5;	%		G51 = 0;	%		G52 = 0;	%		G53 = 0;	%		G54 = 0;	G55 = (1-a5)*c5;	G56 = a5;	G61 = (a1-a4)/(2*c6);	G62 = (1+a1)*a2/(2*c1*c6);	G63 = (1+a1)*(1+a2)*a3/(2*c1*c2*c6);	G64 = (1+a1)*(1+a2)*(1+a3)/(2*c1*c2*c3*c6);	G65 = -(1+a4)*a5/(2*c4*c6);	G66 = (1+a4)*(1+a5)/(2*c4*c5*c6);	%====	G = [	G11, 0, 0, G14, 0, 0;...	0, G22, G23, G24, 0, 0;...	0, 0, G33, G34, 0, 0;...	G41, 0, 0, 0, G45, G46;...	0, 0, 0, 0, G55, G56;...	G61, G62, G63, G64, G65, G66];	%====		D = [G61];	C = [G62, G63, G64, G65, G66];	B = [G11, 0, 0, G41, 0]';	A = [G12, G13, G14, 0, 0;...	G22, G23, G24, 0, 0;...	0, G33, G34, 0, 0;...	0, 0, 0, G45, G46;...	0, 0, 0, G55, G56];		if 1 == 1		% scaling		K = zeros(5,5);		for n = 1:100			K = K + (A^n*B)*(A^n*B)';		end		K = K+ B*B'		x = 1; v = zeros(5,1);ytwo=0;yv = v;		for n = 1:100			y = C*v + D*x;			v = A*v + B*x;			x = 0;			ytwo = ytwo +v*v';			yv = yv +y*y;		end		ytwo		yv		%stop	end	A	B	C	D	M = G*WC; M(M==0) = 1;	% TempCost = sum(sum(mincost(abs(M))));	%		[TempCostM, co, co0, termlog] = MATRIXSCSE2(G*WC, 2);		%		if TempCostM < TempCostM0	x = 1; v = zeros(5,1);	for n = 1:112		h(n) = C*v + D*x;		v = A*v + B*x;		x = 0;	end	figure(4)	PLOT_IMPULSE_RESPONSE_Z(h)			figure(5)	[G, Z, P] = IMPULSE_2_P_Z(h, 5);		Att = PZ_2_ATT_Z(G, Z, P, wT);	Att = Att-min(Att);	subplot('position', [0.08 0.4 0.88 0.5]);		PLOT_ATT_Z(wT, Att, pi, 80)	%	if (min(Att(450:1000)) >= 60) & (max(Att(1:200)) <= 0.1)	%		alfa0 = alfa*WX;	%		Att00 = Att;	%		Wd	%		TempCostM0 = TempCostM	%		alfa0	%	end	%		end	%	end	subplot('position', [0.08 0.4 0.88 0.5]);		%	PLOT_ATT_Z(wT, Att00)		PLOT_ATT_Z(wT, Att, pi,80)		grid on 	%	figure(6)	%	PLOT_PZ_Z(Z, P)			G = C'*C	for n = 1:40		G = A'*G*A +C'*C;	end	S=0	for n = 1:5		S = S+G(n,n);	end	G	S		S=0	for n = 1:5		S = S+K(n,n);	end	S	